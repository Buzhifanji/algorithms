---
icon: sort
title: 归并排序
date: 2022-08-29
description: ''
category:
  - 算法基础
tag:
  - 排序
---

## 介绍

归并排序是建立在归并操作上的一种有效的排序算法。该算法是采用**分治法**（Divide and Conquer）的一个非常典型的应用。将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为2-路归并。

## 动图演示

![alt](/merge-sort.gif)

## 伪代码

```console
MERGE(A, p, q, r)
n1 = q - p + 1
n2 = r -q
let L[1..n1 + 1] and R[1..n2 + 1] be new arrays
for i = 1 to n1
  L[i]= A[p + i -1]
for j = 1 to n2
  R[j] = A[q + j]
L[n1 + 1] = ∞
R[n2 + 1] = ∞
i = 1
j = 1
for k = p to r
  if L[i] <= R[j]
    A[k] = L[i]
    i = i + 1
  else A[k] = R[i]
    j = j + 1
```
```console
MERGE-SORT(A, p, r)
if p < r
  q = (p + r) / 2
  MERGE-SORT(A, p, q)
  MERGE-SORT(A, p + 1, r)
  MERGE(A, p, q, r)
```
## 算法描述

- 把长度为n的输入序列分成两个长度为n/2的子序列；
- 对这两个子序列分别采用归并排序；
- 将两个排序好的子序列合并成一个最终的排序序列。

## 实现

@[code js](../../src/algorithms/sorting/merge-sort.js)

## 证明

我们需要证明第7~28行while循环的第一次迭代之前该循环不变式成立，该循环的每次迭代保持该不变式，并且终止循环时，该不变式提供了一种有用的性质来证明正确性。

- **初始化**：循环的第一次迭代之前，result为空，符合[循环不变式](1.插入排序.md#循环不变式)
- **保持**: 每次循环迭代，会把两个有序数组归并成一个有序数组，查看第13 ~ 27行，通过两个指针，每次迭代都会取出两个数组中的最小值，所有归并之后的数组也是有序的，符合[循环不变式](1.插入排序.md#循环不变式)
- **终止**：当终止循环的时候，根据循环不变式，归并的数组有序的。

## 复杂度

时间复杂度：$O(nlogn)$

空间复杂度：$O(n)$